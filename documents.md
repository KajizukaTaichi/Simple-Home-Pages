# Simple プログラミング言語　ドキュメント
このドキュメントはSimpleプログラミング言語の仕様と文法から、サンプルコードや、実行のしかた、設計哲学まで詳しく解説しています。

## 誕生経緯
そもそも私は現状の教育用プログラミング言語に強い不満を抱いていました。
子どもたちに人気のScratchは子どもにもわかりやすくデザインされているが、
それでは余りコンピュータの動作原理を学ぶことはできず、別途にコンピュータサイエンス教材を学ばなければいけません。
かと言って大学などで使われてきたC言語はコンピュータの動作原理が学べますが、子供には余りにも難しすぎます。

そこで私は子どもにも分かりやすくコンピュータの動作原理が学べる全く新しい教育用プログラミング言語が必要と思い、開発に至ったのです。

## 設計哲学
- なぜ「Simple」という名前なのか？

設計哲学で、最小限のシンプルな機能を工夫してプログラムを作るという考え方からきています。
そのため、イテレータやガベージコレクション、パターンマッチングなどの高レイヤーな機能はありません。
高レイヤーな機能は便利ですが本質的な「コンピュータの動作原理を学ぶ」という理念に相反してしまいます。
小さな機能を組み合わせてプログラムを構築していくのです。その方が論理的思考力を伸ばすのに役立ちます。


## 文法
Simpleはその名の通りシンプルで子どもでも分かりやすい平易な構文です。
スタックの仕組みを学ばせる為に計算方式は逆ポーランド記法を採用しています。
コーディング規約は[こちら](https://github.com/KajizukaTaichi/Simple-Programing-Language/wiki/%E3%82%B3%E3%83%BC%E3%83%87%E3%82%A3%E3%83%B3%E3%82%B0%E8%A6%8F%E7%B4%84)
をご覧ください。

### 変数と式
変数の型は数値型と文字列型とリスト型で、変数を定義するには`var`文を使います。
文法は以下の通りです。
```
var 変数名 = 式
```
文字列リテラルは`"`ダブルクォーテーションか`'`シングルクォーテーションで囲みます。
```
var 変数名 = "文字列"
```
リスト型は`list`に続いて`[` `]`鍵かっこの中にカンマ区切りで式を入れます。
```
var 変数名 = list[式, 式 ..]
```
リストの値を得るには鍵かっこの中に式でインデックスを指定します。
```
print 変数[式]
```
リストの値を変更するにはリスト型変数名に続いて変更するインデックスを式で指定します。
```
var 変数名[式] = 新しい式
```
オペランドは変数とリテラルと関数の戻り値です。
基本的にオペランドは２つですが、否定とデリファレンスは１つです。
論理演算では0がFalseでそれ以外はTrueとなります。
式は逆ポーランド記法で主に以下の演算子があります。

| 演算子 | 種類 | 意味 | 数値 | 文字列 |
| :----:| :---: | :---- | :--:|:--:|
| + |算術| 足し算|◎|◎|
| - |算術|引き算|◎|×|
| * |算術|掛け算|◎|×| 
| / |算術|割り算|◎|×|
| % |算術|割り算の余り|◎|×|
| ^ |算術|べき乗|◎|×|
| = |比較|等しい|◎|◎|
| > |比較|大きい|◎|×|
| < |比較|小さい|◎|×|
| & |論理|AND|◎|×|
| \| |論理|OR|◎|×|
| ! |論理|否定|◎|×|
| ~ |参照|デリファレンス|◎|×|

また、要らなくなった変数は`del`文で削除することができます。
```
del 変数
```
### ポインタ
ポインタは、プログラム内のメモリアドレスを指し示し、変数を参照したり、メモリ内のデータに直接アクセスすることができます。
変数を参照するには`ref`文を用います。
```
ref 参照したい変数
```
なお、参照をポインタ変数に代入するには`=`イコールを用います。
```
ref ポインタ変数 = 参照したい変数
```
ポインタの指し示す値を取得するには`~`デリファレンス演算子を用います。
```
ポインタ ~
```
### 制御構文
制御構文には条件分岐の`if`と繰り返しの`for`と`while`があります。
また、`exit`文で実行しているプロセスを終了できます。
#### 条件分岐
`if`文は条件に一致した時だけ実行します。
```
if 条件式
  条件に一致した時の処理
end if
```
なお、一致しなかった場合の処理は`else`以降に書きます。
```
if 条件式
  条件に一致した時の処理
else
  条件に一致しなかった場合の処理
end if
```
#### 繰り返し
`for`文は式の結果の数だけ繰り返します。
```
for 式
  繰り返す処理
end for
```

`while`文は条件に一致している間繰り返します。
```
while 条件式
  繰り返す処理
end while
```
繰り返し処理において、`break`文でループから脱出できます。
```
if 脱出する条件
  break
end if
```
繰り返し処理において、`next`文で次のループまで飛ばせます。
```
if 飛ばす条件
  next
end if
```
### 入出力
出力は`print`文を用います。
表示したい文字列や式をカンマ区切りで記述します。
文字列リテラルは`"`ダブルクォーテーションか`'`シングルクォーテーションで囲います。
```
print x ,'足す', y,"は", x y +,'です"
```

入力は`input`文を用います。変数に入力値が代入されます。
入力値は式として解釈され、その結果は変数に入ります。
```
input 変数名
```

### 関数
`func`文で関数を定義します。引数はかっこの中にカンマ区切りで記述します。なお、戻り値を返すなら`return`文を用います。
```
func 関数名 (引数1, 引数2 ..)
    関数の行う処理
    return 戻り値
end func
```
`call`文で関数名に続けてかっこの中に引数を記述して関数を呼び出します。
```
call 関数名(引数1, 引数2 ..)
```
戻り値を得たい場合は式の中に記述します。
```
var x = 3 関数名(引数1, 引数2 ..)　* 2 -
```
また、`#`ハッシュ以降の文字列はすべてコメントとなります。
## サンプルコード
以下のサンプルコードは素数判定プログラムです。
```
var true = 1.0　#論理値を設定する
var false = 0.0

func prime(ptr)
    #素数かどうか判定する関数
    #引数はポインタ
    
    if ptr ~ 2 <
        return false
    end if　#2未満は素数ではない

    if ptr ~ 4 <
        return true
    end if　#2以上4未満は素数

    var count = 2
    while count ptr ~ 0.5 ^ <
        if ptr ~ count % 0 =
            return false
        end if #割れるか確かめる
        var count = count 1 +
    end while

    return true #戻り値は論理型
end func

print'素数判定プログラム'
print'Build on Simple programing language'

while true
    #無限に入力を受け付ける
    input number

    if number false =　
        print'終了します'
        break
    end if

    ref ptr = number #numberの参照
    
    #prime関数を呼び出す
    if prime(ptr) true =
        var text = 'は素数です'
    else #表示するテキスト
        var text = 'は素数ではありません'
    end if
    
    print ptr ~, text
end while

```

## 実行
基本的にSimpleは対話モードで学習を進めます。対話モードにはメモリの内容を表示する`mem`コマンドがあります。
対話モードやデバッグモードでは実行結果を表示する前に過程やロジックをログ出力しています。詳しくは[REPLの使い方](https://github.com/KajizukaTaichi/Simple-Programing-Language/wiki/REPL%E3%81%AE%E4%BD%BF%E3%81%84%E6%96%B9)をご参照ください。
`exit`コマンドで対話プログラミングを終了します。

デバッグやスクリプト実行がしたい場合は実行ファイルに続けて実行モードとファイル名を指定します。
スクリプトモードはログ出力をしないので、アプリケーションとして実行する場合に用います。
実行モードを省略すると、スクリプト実行されます。
```
simple.exe 実行モード ファイル名
```
実行モードは以下の通りです。
| 実行モード名 | 省略名 | 挙動 |
| :---: | :---: | :--: |
| run | r |スクリプトモードで実行する |
| debug | d | デバッグモードで実行する |
| interactive| i | 対話モードで実行する |
### デバッグ
デバッガはファイルを一行ずつ実行します。デバッグメニューからデバッグコマンドを実行します。

`mem`デバッグコマンドでメモリの状態を監視したり、`var`文で変数の中身を書き換える事ができます。
デバッグを中断するには`exit`コマンドを用います。

## 終わりに
最後までお読みいただき誠にありがとうございました。実際に教育現場で活用していただく場合には[こちら](https://github.com/KajizukaTaichi/Simple-Programing-Language/wiki/%E6%95%99%E8%82%B2%E7%8F%BE%E5%A0%B4%E3%81%A7%E3%81%AE%E4%BD%BF%E7%94%A8)をご覧ください。
